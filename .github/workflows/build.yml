name: Convert XCArchive to IPA

on:
  workflow_dispatch: # Allows manual triggering

jobs:
  build:
    runs-on: macos-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Unzip Archive
        run: unzip build.xcarchive.zip

      - name: Export IPA
        run: |
          xcodebuild -exportArchive \
            -archivePath build.xcarchive \
            -exportPath output_folder \
            -exportOptionsPlist exportOptions.plist

      - name: Upload IPA
        uses: actions/upload-artifact@v3
        with:
          name: app
          path: output_folder/*.ipa
